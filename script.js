         const subjectsData = {
             greetings: [
         				{ hebrew: "שלום", spanish: "Hola", phonetic: "אולה" },
         				{ hebrew: "בוקר טוב", spanish: "Buenos días", phonetic: "בואנוס דיאס" },
         				{ hebrew: "אחר צהריים טובים", spanish: "Buenas tardes", phonetic: "בואנס טארדס" },
         				{ hebrew: "ערב טוב/לילה טוב", spanish: "Buenas noches", phonetic: "בואנס נוצ'ס" },
         				{ hebrew: "להתראות", spanish: "Adiós", phonetic: "אדיוס" },
         				{ hebrew: "נתראה אחר כך", spanish: "Hasta luego", phonetic: "אסטה לואגו" },
         				{ hebrew: "מה שלומך?", spanish: "¿Cómo estás?", phonetic: "קומו אסטאס" },
         				{ hebrew: "אני בסדר, תודה", spanish: "Estoy bien, gracias", phonetic: "אסטוי ביאן, גראסיאס" },
         				{ hebrew: "קוראים לי [שם]", spanish: "Me llamo [nombre]", phonetic: "מה ייאמו [נומברה]" },
         				{ hebrew: "נעים מאוד", spanish: "Mucho gusto", phonetic: "מוצ'ו גוסטו" }
                 // ... (other greetings)
             ],
             school: [
         				{ hebrew: "איפה הכיתה שלי?", spanish: "¿Dónde está mi clase?", phonetic: "דונדה אסטה מי קלאסה" },
         				{ hebrew: "אפשר ללכת לשירותים?", spanish: "¿Puedo ir al baño?", phonetic: "פואדו איר אל באניו" },
         				{ hebrew: "אני לא מבין/ה", spanish: "No entiendo", phonetic: "נו אנטיינדו" },
         				{ hebrew: "אתה יכול לחזור על זה, בבקשה?", spanish: "¿Puedes repetir, por favor?", phonetic: "פואדס רפטיר, פור פאבור" },
         				{ hebrew: "איך אומרים... בספרדית?", spanish: "¿Cómo se dice... en español?", phonetic: "קומו סה דיסה... אן אספניול" },
         				{ hebrew: "מה המשמעות של המילה הזו?", spanish: "¿Qué significa esta palabra?", phonetic: "קה סיגניפיקה אסטה פלאברה" },
         				{ hebrew: "אפשר לשאול עיפרון?", spanish: "¿Puedo tomar prestado un lápiz?", phonetic: "פואדו טומאר פרסטאדו און לאפיס" },
         				{ hebrew: "מתי ההפסקה?", spanish: "¿Cuándo es el recreo?", phonetic: "קואנדו אס אל רקראו" },
         				{ hebrew: "אתה יכול לעזור לי, בבקשה?", spanish: "¿Puedes ayudarme, por favor?", phonetic: "פואדס איודארמה, פור פאבור" },
         				{ hebrew: "סיימתי את שיעורי הבית", spanish: "He terminado mi tarea", phonetic: "א טרמינאדו מי טאראה" }
                 // ... (other school-related phrases)
             ],
             food: [
         				{ hebrew: "אני רעב/ה", spanish: "Tengo hambre", phonetic: "טנגו אמברה" },
         				{ hebrew: "אני צמא/ה", spanish: "Tengo sed", phonetic: "טנגו סד" },
         				{ hebrew: "מה יש לאכול?", spanish: "¿Qué hay de comer?", phonetic: "קה אי דה קומר" },
         				{ hebrew: "אני אוהב/ת...", spanish: "Me gusta...", phonetic: "מה גוסטה" },
         				{ hebrew: "אני לא אוהב/ת...", spanish: "No me gusta...", phonetic: "נו מה גוסטה" },
         				{ hebrew: "אפשר עוד, בבקשה?", spanish: "¿Puedo tener más, por favor?", phonetic: "פואדו טנר מאס, פור פבור" },
         				{ hebrew: "זה טעים", spanish: "Está delicioso", phonetic: "אסטה דליסיוסו" },
         				{ hebrew: "איפה חדר האוכל?", spanish: "¿Dónde está el comedor?", phonetic: "דונדה אסטה אל קומדור" },
         				{ hebrew: "באיזו שעה ארוחת הערב?", spanish: "¿A qué hora es la cena?", phonetic: "א קה אורה אס לה סנה" },
         				{ hebrew: "יש לי אלרגיה ל...", spanish: "Soy alérgica a...", phonetic: "סוי אלרחיקה א" }
                 // ... (other food-related phrases)
             ],
             feelings: [
         				{ hebrew: "אני שמח/ה", spanish: "Estoy feliz", phonetic: "אסטוי פליס" },
         				{ hebrew: "אני עצוב/ה", spanish: "Estoy triste", phonetic: "אסטוי טריסטה" },
         				{ hebrew: "אני עייפ/ה", spanish: "Estoy cansada", phonetic: "אסטוי קנסדה" },
         				{ hebrew: "אני מפחד/ת", spanish: "Tengo miedo", phonetic: "טנגו מיידו" },
         				{ hebrew: "אני נרגש/ת", spanish: "Estoy emocionada", phonetic: "אסטוי אמוסיונדה" },
         				{ hebrew: "אני מרגיש/ה לא טוב", spanish: "Me siento mal", phonetic: "מה סיינטו מאל" },
         				{ hebrew: "אני לחוץ/ה", spanish: "Estoy nerviosa", phonetic: "אסטוי נרביוסה" },
         				{ hebrew: "כואב לי ה...", spanish: "Me duele...", phonetic: "מה דואלה" },
         				{ hebrew: "אני צריך/ה עזרה", spanish: "Necesito ayuda", phonetic: "נססיטו איודה" },
         				{ hebrew: "אפשר להתקשר הביתה?", spanish: "¿Puedo llamar a casa?", phonetic: "פואדו ייאמר א קסה" }
                 // ... (other feelings)
             ],
             family: [
         				{ hebrew: "המשפחה שלי", spanish: "Mi familia", phonetic: "מי פמיליה" },
         				{ hebrew: "אמא/אבא שלי", spanish: "Mi madre/papá", phonetic: "מי מדרה/פפה" },
         				{ hebrew: "אח/אחות שלי", spanish: "Mi hermano/hermana", phonetic: "מי ארמנו/ארמנה" },
         				{ hebrew: "סבא וסבתא שלי", spanish: "Mis abuelos", phonetic: "מיס אבואלוס" },
         				{ hebrew: "דוד/דודה שלי", spanish: "Mi tío/tía", phonetic: "מי טיו/טיה" },
         				{ hebrew: "בן/בת דוד שלי", spanish: "Mi primo/prima", phonetic: "מי פרימו/פרימה" },
         				{ hebrew: "יש לך חיות מחמד?", spanish: "¿Tienes mascotas?", phonetic: "טיינס מסקוטס" },
         				{ hebrew: "יש לי כלב/חתול", spanish: "Tengo un perro/gato", phonetic: "טנגו און פרו/גטו" },
         				{ hebrew: "כמה אחים יש לך?", spanish: "¿Cuántos hermanos tienes?", phonetic: "קואנטוס ארמנוס טיינס" },
         				{ hebrew: "אני גר/ה עם...", spanish: "Vivo con...", phonetic: "ביבו קון" }
                 // ... (other family-related phrases)
             ],
             hobbies: [
         					{ hebrew: "אני אוהב/ת לצייר", spanish: "Me gusta dibujar", phonetic: "מה גוסטה דיבוחר" },
         					{ hebrew: "את/ה רוצה לצבוע איתי?", spanish: "¿Quieres colorear conmigo?", phonetic: "קיירס קולוראר קונמיגו" },
         					{ hebrew: "בוא/י נשחק בחוץ", spanish: "Vamos a jugar afuera", phonetic: "במוס א חוגר אפוארה" },
         					{ hebrew: "הספורט האהוב עלי הוא...", spanish: "Mi deporte favorito es...", phonetic: "מי דפורטה פבוריטו אס" },
         					{ hebrew: "את/ה יודע/ת לרכוב על אופניים?", spanish: "¿Sabes andar en bicicleta?", phonetic: "סבס אנדר אן ביסיקלטה" },
         					{ hebrew: "אני אוהב/ת מאוד לקרוא", spanish: "Me encanta leer", phonetic: "מה אנקנטה לאר" },
         					{ hebrew: "את/ה מנגן/ת על איזשהו כלי?", spanish: "¿Tocas algún instrumento?", phonetic: "טוקס אלגון אינסטרומנטו" },
         					{ hebrew: "בוא/י נלך לפארק", spanish: "Vamos al parque", phonetic: "במוס אל פרקה" },
         					{ hebrew: "אפשר לראות טלוויזיה?", spanish: "¿Puedo ver la televisión?", phonetic: "פואדו בר לה טלביסיון" },
         					{ hebrew: "יש לך משחקי קופסה?", spanish: "¿Tienes juegos de mesa?", phonetic: "טיינס חואגוס דה מסה" }
                 // ... (other hobby-related phrases)
             ]
         };

let currentSubject = 'greetings';
let currentSentence;
let streak = 0;
let bestStreak = 0;

const subjectSelect = document.getElementById('subject-select');
const gameModeSelect = document.getElementById('game-mode-select');
const hebrewBox = document.getElementById('hebrew-box');
const spanishBox = document.getElementById('spanish-box');
const hebrewSentence = document.getElementById('hebrew-sentence');
const spanishSentence = document.getElementById('spanish-sentence');
const spanishPhonetic = document.getElementById('spanish-phonetic');
const showAnswerButton = document.getElementById('show-answer');
const answerButtons = document.querySelector('.answer-buttons');
const correctButton = document.getElementById('correct');
const incorrectButton = document.getElementById('incorrect');
const currentStreakElement = document.getElementById('current-streak');
const bestStreakElement = document.getElementById('best-streak');
const ttsAudio = document.getElementById('tts-audio');

function getAllSentences() {
    return Object.values(subjectsData).flat();
}

function populateSubjectSelect() {
    subjectSelect.innerHTML = '';
    const allOption = document.createElement('option');
    allOption.value = 'all';
    allOption.textContent = 'All categories';
    subjectSelect.appendChild(allOption);
    for (const subject in subjectsData) {
        const option = document.createElement('option');
        option.value = subject;
        option.textContent = subject.charAt(0).toUpperCase() + subject.slice(1);
        subjectSelect.appendChild(option);
    }
}

function adjustFontSize() {
    const boxes = [hebrewBox, spanishBox];
    boxes.forEach(box => {
        const content = box.querySelector('.content') || box;
        const sentence = content.querySelector('.sentence');
        const phonetic = content.querySelector('.phonetic');
        let fontSize = 2;
        content.style.display = 'flex';
        while (content.scrollHeight > content.clientHeight && fontSize > 0.8) {
            fontSize -= 0.1;
            sentence.style.fontSize = `${fontSize}rem`;
            if (phonetic) {
                phonetic.style.fontSize = `${fontSize * 0.75}rem`;
            }
        }
        content.style.display = '';
    });
}

function getNextSentence() {
    currentSubject = subjectSelect.value;
    let subjectData;
    if (currentSubject === 'all') {
        subjectData = getAllSentences();
    } else {
        subjectData = subjectsData[currentSubject];
    }
    const randomIndex = Math.floor(Math.random() * subjectData.length);
    currentSentence = subjectData[randomIndex];
    const gameMode = gameModeSelect.value;

    hebrewSentence.textContent = '';
    spanishSentence.textContent = '';
    spanishPhonetic.textContent = '';

    if (gameMode === 'Hebrew to Spanish' || (gameMode === 'Random' && Math.random() < 0.5)) {
        hebrewSentence.textContent = currentSentence.hebrew;
        hebrewSentence.classList.remove('hidden');
        spanishSentence.classList.add('hidden');
        spanishPhonetic.classList.add('hidden');
        spanishBox.classList.remove('has-content');
    } else {
        spanishSentence.textContent = currentSentence.spanish;
        spanishPhonetic.textContent = currentSentence.phonetic;
        spanishSentence.classList.remove('hidden');
        spanishPhonetic.classList.remove('hidden');
        hebrewSentence.classList.add('hidden');
        spanishBox.classList.add('has-content');
    }

    showAnswerButton.style.display = 'block';
    answerButtons.style.display = 'none';
    adjustFontSize();
}


function speak(text) {
    if (responsiveVoice) {
        responsiveVoice.speak(text, 'Spanish Female', {
            onend: () => {
                console.log('Speech finished.');
            },
            onerror: (error) => {
                console.error('Error playing audio:', error);
                alert('Sorry, there was an error playing the audio. Please try again.');
            }
        });
    } else {
        alert('ResponsiveVoice is not available.');
    }
}

// Ensure to include the ResponsiveVoice JS library in your HTML


// function speak(text) {
//     const url = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=es&client=tw-ob`;
//     ttsAudio.src = url;
//     ttsAudio.play().catch(error => {
//         console.error('Error playing audio:', error);
//         alert('Sorry, there was an error playing the audio. Please try again.');
//     });
// }
// 

spanishBox.addEventListener('click', () => {
    if (spanishSentence.textContent && !spanishSentence.classList.contains('hidden')) {
        speak(spanishSentence.textContent);
    }
});

function showAnswer() {
    hebrewSentence.textContent = currentSentence.hebrew;
    spanishSentence.textContent = currentSentence.spanish;
    spanishPhonetic.textContent = currentSentence.phonetic;
    hebrewSentence.classList.remove('hidden');
    spanishSentence.classList.remove('hidden');
    spanishPhonetic.classList.remove('hidden');
    spanishBox.classList.add('has-content');
    showAnswerButton.style.display = 'none';
    answerButtons.style.display = 'flex';
    adjustFontSize();
}

function handleAnswer(correct) {
    if (correct) {
        streak++;
        if (streak > bestStreak) {
            bestStreak = streak;
            bestStreakElement.textContent = bestStreak;
        }
    } else {
        streak = 0;
    }
    currentStreakElement.textContent = streak;
    getNextSentence();
}

showAnswerButton.addEventListener('click', showAnswer);
correctButton.addEventListener('click', () => handleAnswer(true));
incorrectButton.addEventListener('click', () => handleAnswer(false));
subjectSelect.addEventListener('change', getNextSentence);
gameModeSelect.addEventListener('change', getNextSentence);

populateSubjectSelect();
getNextSentence();